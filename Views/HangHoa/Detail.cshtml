@model KLTN_E.ViewModels.ChiTietHangHoaVM
@{
    ViewData["Title"] = "Detail";
}
<!-- Shop Details Section Begin -->
<section class="shop-details">
    <div class="product__details__pic">
        <div class="container">
            <div class="row">
                <div class="col-lg-12">
                    <div class="product__details__breadcrumb text-left">
                        <a href="/">Home</a>
                        <a asp-controller="HangHoa">Shop</a>
                        <span>@Model.TenHH</span>
                    </div>
                </div>
            </div>
            <div class="row">
                <div class="col-lg-12 col-md-9  d-flex justify-content-between ">

                    <div class="col-lg-5" style="padding:0px">
                        <div class="product__details__pic__item">
                            @* <a asp-action="Detail" asp-route-id="@Model.MaHH"> *@
                            <img src="~/Hinh/HangHoa/@Model.Hinh" alt="@Model.TenHH">
                            @* </a> *@
                        </div>


                    </div>

                    <div class="col-lg-6">
                        <form asp-action="AddToCart" asp-controller="Cart" asp-route-id="@Model.MaHH">
                            <div class="product__details__text text-left">
                                <h4>@Model.TenHH</h4>
                                <div class="rating">
                                    <i class="fa fa-star"></i>
                                    <i class="fa fa-star"></i>
                                    <i class="fa fa-star"></i>
                                    <i class="fa fa-star"></i>
                                    <i class="fa fa-star-o"></i>
                                    <span> - 5 Reviews</span>
                                </div>
                                <h3>$@Model.DonGia <span>70.00</span></h3>
                                <p>
                                    @Model.MoTa
                                </p>

                                <div class="product__details__cart__option">
                                    <div class="quantity">
                                        <div class="pro-qty">
                                            <input type="text" value="1" name="quantity">
                                        </div>
                                    </div>
                                    <button class="primary-btn">add to cart</button>
                                </div>
                                <div class="product__details__btns__option">
                                    <a href="#"><i class="fa fa-heart"></i> add to wishlist</a>
                                    <a href="#"><i class="fa fa-exchange"></i> Add To Compare</a>
                                </div>
                                <div class="product__details__last__option">
                                    <h5><span>Guaranteed Safe Checkout</span></h5>
                                    <img src="img/shop-details/details-payment.png" alt="">
                                    <ul>
                                        <li><span>SKU:</span> @Model.MaHH</li>
                                        <li><span>Categories:</span> @Model.TenLoai</li>
                                    </ul>
                                </div>
                            </div>
                        </form>
                    </div>

                </div>

                <div>
                </div>

            </div>
        </div>
    </div>
    <!-- Form thêm comment mới -->
    @if (User.Identity.IsAuthenticated)
    {
        <h5>Comments (@Model.Comments.Count)</h5>
        <form asp-action="AddComment" asp-controller="Comment" method="post">
            <input type="hidden" name="productId" value="@Model.MaHH" />
            <textarea name="content" rows="2" cols="30"></textarea>
            <button type="submit">Submit</button>
        </form>
    }
    else
    {
        <p>Please <a asp-action="DangNhap" asp-controller="KhachHang">log in</a> to leave a comment.</p>
    }

  @*   @foreach (var comment in Model.Comments)
    {
        <div>
            <small>Posted by: @comment.Name - @comment.CreatedDate.ToShortDateString()</small>
            <p>@comment.Content</p>
            <button type="button" class="btn btn-success" onclick="showEditForm(@comment.Id)">Edit</button>
            <div id="edit-form-@comment.Id" style="display:none;">
                <form asp-action="EditComment" asp-controller="Comment" method="post">
                    <input type="hidden" name="CommentId" value="@comment.Id" />
                    <textarea name="Content" rows="4" cols="50">@comment.Content</textarea>
                    <button type="submit" class="btn btn-primary">Save</button>
                    <button type="button" class="btn btn-secondary" onclick="hideEditForm(@comment.Id)">Cancel</button>
                </form>
                <form asp-action="DeleteComment" asp-controller="Comment" method="post">
                    <input type="hidden" name="CommentId" value="@comment.Id" />
                    <button type="submit" class="btn btn-danger">Delete</button>
                </form>
            </div>

        </div>
    } *@
    @foreach (var comment in Model.Comments)
    {
        <div>
            <small>Posted by: @comment.Name - @comment.CreatedDate.ToShortDateString()</small>
            <p>@comment.Content</p>
            <button type="button" class="btn btn-success" onclick="showEditForm(@comment.Id)">Edit</button>
            <form asp-action="DeleteComment" asp-controller="Comment" method="post" style="display:inline;">
                <input type="hidden" name="CommentId" value="@comment.Id" />
                <button type="submit" class="btn btn-danger">Delete</button>
            </form>
            <div id="edit-form-@comment.Id" style="display:none; margin-top: 10px;">
                <form asp-action="EditComment" asp-controller="Comment" method="post">
                    <input type="hidden" name="CommentId" value="@comment.Id" />
                    <textarea name="Content" rows="4" cols="50">@comment.Content</textarea>
                    <button type="submit" class="btn btn-primary">Save</button>
                    <button type="button" class="btn btn-secondary" onclick="hideEditForm(@comment.Id)">Cancel</button>
                </form>
            </div>
        </div>
    }


    <div class="row">
        <div class="col-lg-12">
            <div class="product__pagination">
                @for (int i = 1; i <= Model.TotalPages; i++)
                {
                    if (i == Model.CurrentPage)
                    {
                        <span>@i</span>
                    }
                    else
                    {
                        <a href="@Url.Action("Detail", new { id = Model.MaHH, page = i, pageSize = Model.PageSize })">@i</a>
                    }
                }
            </div>
        </div>
    </div>

</section>

<script>
    function showEditForm(commentId) {
        document.getElementById('edit-form-' + commentId).style.display = 'block';
    }

    function hideEditForm(commentId) {
        document.getElementById('edit-form-' + commentId).style.display = 'none';
    }
</script>

<!-- Shop Details Section End -->
